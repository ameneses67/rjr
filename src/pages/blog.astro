---
// Librerías
import { getCollection } from "astro:content";

// Layouts
import MainLayout from "../layouts/MainLayout.astro";

// Componentes
import BlogHero from "../components/blog/BlogHero.astro";
import BlogCard from "../components/blog/BlogCard.astro";

// Filtrar posts draft=true y no futuros
export const publishedBlogPosts = await getCollection(
  "blog",
  ({ data }) => !data.draft && data.publishDate < new Date(),
);

// Ordenar posts por fecha
publishedBlogPosts.sort(
  (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf(),
);

export const title = "Blog";
export const description =
  "En nuestro blog encontrarás artículos básicos que te ayudarán a empezar a educarte en finanzas personales.";
---

<MainLayout {title} {description}>
  <BlogHero />
  <section class="container mx-auto space-y-12 px-4 sm:space-y-16 sm:px-6">
    {
      publishedBlogPosts.map((post) => (
        <article class="mx-auto max-w-3xl space-y-6 border-b border-slate-200 pb-12 dark:border-slate-800 sm:pb-16">
          <BlogCard
            blogTitle={post.data.title}
            updatedDate={post.data.updateDate}
            author={post.data.author}
            snippet={post.data.snippet}
            imgSrc={post.data.image.src}
            imgAlt={post.data.image.alt}
            category={post.data.category}
            slug={post.slug}
          />
        </article>
      ))
    }
  </section>
</MainLayout>
